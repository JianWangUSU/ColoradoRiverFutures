#Specify fill colors for equalization tier quadrants
scale_fill_manual(breaks=c(1:7),values = cTierColors,labels = dfReleases$Release) +
theme_bw() +
coord_fixed() +
guides(size = "none", colour = guide_legend("Historical volumes (year)"), fill="none") +
labs(x="Powell Active Storage (MAF)", y="Mead Active Storage (MAF)", fill = "Powell Release (MAF/year)") +
theme(text = element_text(size=20), legend.text=element_text(size=16),
panel.border = element_rect(colour = "black", fill="NA"),
legend.background = element_blank(),
legend.box.background = element_rect(colour = "black", fill=palGreys[2]),
legend.position = c(1.13,0.620))
print(p)
#Low Resolution version
ggsave(paste0(cFileNames[i],cFileType), width=9, height = 6.5, units="in", dpi=96)
#High Resolution version
ggsave(paste0(cFileNames[i],"-HRES",cFileType), width=9, height = 6.5, units="in", dpi=300)
}
for (i in cS){
p <- ggplot(dfPolyAll, aes(x = PowellVol, y = MeadVol)) +
#Background tiers of different blues
geom_polygon(aes(fill = as.factor(DumVal), group = id)) +
#Plot equalization lines for years
geom_line(data = dfPowellEqPlot, aes(x = Volume, y = value,group=Year, color="Equalization levels (Year)"),size=1.25, linetype=2, show.legend = FALSE) +
#Label the boundary between the Upper Equalization Tier and the Equalization Tier (year dependent)
geom_text(data=dfPowellEqLevelsFilt, aes( x = Volume + 0.4, y = MeadEnd/5, label = YearAsLabel), color="black", angle = 90, size = 5) +
# Plot a 1:1 line to total storage
geom_line(data=dfOneToOneByVolume,aes(x=PowellStor,y=MeadStor, group=1, color="1:1 line (by volume)"), size=2, linetype="longdash", show.legend = FALSE) +
#Label the 1:1 line
geom_text(aes(x=3.5,y=4.2,label="1:1 line"), color="black", angle = 45, size =6, show.legend = FALSE)
if (i==2){
#Overplot Mead-Powell historical storage -- January of each year
#Before guidelines in place in Red
p<- p + geom_path(data = dfJointStorageFiltBefore, aes(x = PowellStorage, y = MeadStorage, color="Before Guidelines"), size=1.5, linetype=1, show.legend = TRUE)
#After guidelines in place in purple
p<- p + geom_path(data = dfJointStorageFiltAfter, aes(x = PowellStorage, y = MeadStorage, color="After Guidelines"), size=1.5, linetype=1, show.legend = TRUE)
}
if (i==3){
#Overplot Mead-Powell historical storage -- all months
#Before guidelines in place in Red
p <- p+ geom_path(data = dfJointStorageBefore, aes(x = PowellStorage, y = MeadStorage, color="Before Guidelines"), size=1, linetype=1, show.legend = TRUE)
#After guidelines in place in Purple
p <- p+ geom_path(data = dfJointStorageAfter, aes(x = PowellStorage, y = MeadStorage, color="After Guidelines"), size=1, linetype=1, show.legend = TRUE)
}
if (i==2 || i==3) {
#Label the each January with it's year
p <- p + geom_text(data=dfJointStorageFiltBefore, aes( x = PowellStorage, y = MeadStorage, label = year(DateAsValue), color="BeforeGuidesText", angle = 0, size = 4, check_overlap = TRUE))
p <- p + geom_text(data=dfJointStorageFiltAfter, aes( x = PowellStorage, y = MeadStorage, label = year(DateAsValue), color="AfterGuidesText", angle = 0, size = 4, check_overlap = TRUE))
}
#set colors for lines
p <- p + scale_color_manual(breaks = c("Before Guidelines", "After Guidelines"),
values= c("black",palPurples[8], "black", palPurples[6], "black","black"),
labels = c("Before Guidelines", "With Guidelines")) +
#Label the equalization tiers with white callouts
geom_label(data=dfPowellTiers, aes(x = PowellMidVol, y = MeadMid, label = Tier, fontface="bold"), size=5, angle = 0) +
#Label the annual release amount within each equalization tier
geom_text(data=dfReleases, aes( x = MidPowell, y = MidMead, label = Release), angle = 0, size = 5) +
#Create secondary y axes for Mead Lake Level
scale_y_continuous(breaks = c(0,5,10,15,20,25),labels=c(0,5,10,15, 20,25),  sec.axis = sec_axis(~. +0, name = "Mead Level (feet)", breaks = dfMeadPoolsPlot$stor_maf, labels = dfMeadPoolsPlot$label)) +
#Create secodary x axes for Powell Lake Level
scale_x_continuous(sec.axis = sec_axis(~. +0, name = "Powell Level (feet)", breaks = c(0,5.93,9.52,15.54,19.29,24.32) , labels = c(3370,3525,3575,3636,3666,3700))) +
#Specify fill colors for equalization tier quadrants
scale_fill_manual(breaks=c(1:7),values = cTierColors,labels = dfReleases$Release) +
theme_bw() +
coord_fixed() +
guides(size = "none", colour = guide_legend("Historical volumes (year)"), fill="none") +
labs(x="Powell Active Storage (MAF)", y="Mead Active Storage (MAF)", fill = "Powell Release (MAF/year)") +
theme(text = element_text(size=20), legend.text=element_text(size=16),
panel.border = element_rect(colour = "black", fill="NA"),
legend.background = element_blank(),
legend.box.background = element_rect(colour = "black", fill=palGreys[2]),
legend.position = c(1.13,0.620))
print(p)
#Low Resolution version
ggsave(paste0(cFileNames[i],cFileType), width=9, height = 6.5, units="in", dpi=96)
#High Resolution version
ggsave(paste0(cFileNames[i],"-HRES",cFileType), width=9, height = 6.5, units="in", dpi=300)
}
devtools::install_github("slowkow/ggrepel")
library(ggrepel)
for (i in cS){
p <- ggplot(dfPolyAll, aes(x = PowellVol, y = MeadVol)) +
#Background tiers of different blues
geom_polygon(aes(fill = as.factor(DumVal), group = id)) +
#Plot equalization lines for years
geom_line(data = dfPowellEqPlot, aes(x = Volume, y = value,group=Year, color="Equalization levels (Year)"),size=1.25, linetype=2, show.legend = FALSE) +
#Label the boundary between the Upper Equalization Tier and the Equalization Tier (year dependent)
geom_text(data=dfPowellEqLevelsFilt, aes( x = Volume + 0.4, y = MeadEnd/5, label = YearAsLabel), color="black", angle = 90, size = 5) +
# Plot a 1:1 line to total storage
geom_line(data=dfOneToOneByVolume,aes(x=PowellStor,y=MeadStor, group=1, color="1:1 line (by volume)"), size=2, linetype="longdash", show.legend = FALSE) +
#Label the 1:1 line
geom_text(aes(x=3.5,y=4.2,label="1:1 line"), color="black", angle = 45, size =6, show.legend = FALSE)
if (i==2){
#Overplot Mead-Powell historical storage -- January of each year
#Before guidelines in place in Red
p<- p + geom_path(data = dfJointStorageFiltBefore, aes(x = PowellStorage, y = MeadStorage, color="Before Guidelines"), size=1.5, linetype=1, show.legend = TRUE)
#After guidelines in place in purple
p<- p + geom_path(data = dfJointStorageFiltAfter, aes(x = PowellStorage, y = MeadStorage, color="After Guidelines"), size=1.5, linetype=1, show.legend = TRUE)
}
if (i==3){
#Overplot Mead-Powell historical storage -- all months
#Before guidelines in place in Red
p <- p+ geom_path(data = dfJointStorageBefore, aes(x = PowellStorage, y = MeadStorage, color="Before Guidelines"), size=1, linetype=1, show.legend = TRUE)
#After guidelines in place in Purple
p <- p+ geom_path(data = dfJointStorageAfter, aes(x = PowellStorage, y = MeadStorage, color="After Guidelines"), size=1, linetype=1, show.legend = TRUE)
}
if (i==2 || i==3) {
#Label the each January with it's year
p <- p + geom_text(data=dfJointStorageFiltBefore, aes( x = PowellStorage, y = MeadStorage, label = year(DateAsValue), color="BeforeGuidesText", angle = 0, size = 4, check_overlap = TRUE))
#p <- p + geom_text(data=dfJointStorageFiltAfter, aes( x = PowellStorage, y = MeadStorage, label = year(DateAsValue), color="AfterGuidesText", angle = 0, size = 4, check_overlap = TRUE))
p <- p + geom_text_repel(data=dfJointStorageFiltAfter, aes( x = PowellStorage, y = MeadStorage, label = year(DateAsValue), color="AfterGuidesText", angle = 0, size = 4, check_overlap = TRUE))
}
#set colors for lines
p <- p + scale_color_manual(breaks = c("Before Guidelines", "After Guidelines"),
values= c("black",palPurples[8], "black", palPurples[5], "black","black"),
labels = c("Before Guidelines", "With Guidelines")) +
#Label the equalization tiers with white callouts
geom_label(data=dfPowellTiers, aes(x = PowellMidVol, y = MeadMid, label = Tier, fontface="bold"), size=5, angle = 0) +
#Label the annual release amount within each equalization tier
geom_text(data=dfReleases, aes( x = MidPowell, y = MidMead, label = Release), angle = 0, size = 5) +
#Create secondary y axes for Mead Lake Level
scale_y_continuous(breaks = c(0,5,10,15,20,25),labels=c(0,5,10,15, 20,25),  sec.axis = sec_axis(~. +0, name = "Mead Level (feet)", breaks = dfMeadPoolsPlot$stor_maf, labels = dfMeadPoolsPlot$label)) +
#Create secodary x axes for Powell Lake Level
scale_x_continuous(sec.axis = sec_axis(~. +0, name = "Powell Level (feet)", breaks = c(0,5.93,9.52,15.54,19.29,24.32) , labels = c(3370,3525,3575,3636,3666,3700))) +
#Specify fill colors for equalization tier quadrants
scale_fill_manual(breaks=c(1:7),values = cTierColors,labels = dfReleases$Release) +
theme_bw() +
coord_fixed() +
guides(size = "none", colour = guide_legend("Historical volumes (year)"), fill="none") +
labs(x="Powell Active Storage (MAF)", y="Mead Active Storage (MAF)", fill = "Powell Release (MAF/year)") +
theme(text = element_text(size=20), legend.text=element_text(size=16),
panel.border = element_rect(colour = "black", fill="NA"),
legend.background = element_blank(),
legend.box.background = element_rect(colour = "black", fill=palGreys[2]),
legend.position = c(1.13,0.620))
print(p)
#Low Resolution version
ggsave(paste0(cFileNames[i],cFileType), width=9, height = 6.5, units="in", dpi=96)
#High Resolution version
ggsave(paste0(cFileNames[i],"-HRES",cFileType), width=9, height = 6.5, units="in", dpi=300)
}
for (i in cS){
p <- ggplot(dfPolyAll, aes(x = PowellVol, y = MeadVol)) +
#Background tiers of different blues
geom_polygon(aes(fill = as.factor(DumVal), group = id)) +
#Plot equalization lines for years
geom_line(data = dfPowellEqPlot, aes(x = Volume, y = value,group=Year, color="Equalization levels (Year)"),size=1.25, linetype=2, show.legend = FALSE) +
#Label the boundary between the Upper Equalization Tier and the Equalization Tier (year dependent)
geom_text(data=dfPowellEqLevelsFilt, aes( x = Volume + 0.4, y = MeadEnd/5, label = YearAsLabel), color="black", angle = 90, size = 5) +
# Plot a 1:1 line to total storage
geom_line(data=dfOneToOneByVolume,aes(x=PowellStor,y=MeadStor, group=1, color="1:1 line (by volume)"), size=2, linetype="longdash", show.legend = FALSE) +
#Label the 1:1 line
geom_text(aes(x=3.5,y=4.2,label="1:1 line"), color="black", angle = 45, size =6, show.legend = FALSE)
if (i==2){
#Overplot Mead-Powell historical storage -- January of each year
#Before guidelines in place in Red
p<- p + geom_path(data = dfJointStorageFiltBefore, aes(x = PowellStorage, y = MeadStorage, color="Before Guidelines"), size=1.5, linetype=1, show.legend = TRUE)
#After guidelines in place in purple
p<- p + geom_path(data = dfJointStorageFiltAfter, aes(x = PowellStorage, y = MeadStorage, color="After Guidelines"), size=1.5, linetype=1, show.legend = TRUE)
}
if (i==3){
#Overplot Mead-Powell historical storage -- all months
#Before guidelines in place in Red
p <- p+ geom_path(data = dfJointStorageBefore, aes(x = PowellStorage, y = MeadStorage, color="Before Guidelines"), size=1, linetype=1, show.legend = TRUE)
#After guidelines in place in Purple
p <- p+ geom_path(data = dfJointStorageAfter, aes(x = PowellStorage, y = MeadStorage, color="After Guidelines"), size=1, linetype=1, show.legend = TRUE)
}
if (i==2 || i==3) {
#Label the each January with it's year
p <- p + geom_text_repel(data=dfJointStorageFiltBefore[-seq(0,length(dfJointStorageFiltBefore),2),], aes( x = PowellStorage, y = MeadStorage, label = year(DateAsValue), color="BeforeGuidesText", angle = 0, size = 4, check_overlap = TRUE))
#p <- p + geom_text(data=dfJointStorageFiltAfter, aes( x = PowellStorage, y = MeadStorage, label = year(DateAsValue), color="AfterGuidesText", angle = 0, size = 4, check_overlap = TRUE))
p <- p + geom_text_repel(data=dfJointStorageFiltAfter[-seq(0,length(dfJointStorageFiltBefore),2),], aes( x = PowellStorage, y = MeadStorage, label = year(DateAsValue), color="AfterGuidesText", angle = 0, size = 4, check_overlap = TRUE))
}
#set colors for lines
p <- p + scale_color_manual(breaks = c("Before Guidelines", "After Guidelines"),
values= c("black",palPurples[8], "black", palPurples[5], "black","black"),
labels = c("Before Guidelines", "With Guidelines")) +
#Label the equalization tiers with white callouts
geom_label(data=dfPowellTiers, aes(x = PowellMidVol, y = MeadMid, label = Tier, fontface="bold"), size=5, angle = 0) +
#Label the annual release amount within each equalization tier
geom_text(data=dfReleases, aes( x = MidPowell, y = MidMead, label = Release), angle = 0, size = 5) +
#Create secondary y axes for Mead Lake Level
scale_y_continuous(breaks = c(0,5,10,15,20,25),labels=c(0,5,10,15, 20,25),  sec.axis = sec_axis(~. +0, name = "Mead Level (feet)", breaks = dfMeadPoolsPlot$stor_maf, labels = dfMeadPoolsPlot$label)) +
#Create secodary x axes for Powell Lake Level
scale_x_continuous(sec.axis = sec_axis(~. +0, name = "Powell Level (feet)", breaks = c(0,5.93,9.52,15.54,19.29,24.32) , labels = c(3370,3525,3575,3636,3666,3700))) +
#Specify fill colors for equalization tier quadrants
scale_fill_manual(breaks=c(1:7),values = cTierColors,labels = dfReleases$Release) +
theme_bw() +
coord_fixed() +
guides(size = "none", colour = guide_legend("Historical volumes (year)"), fill="none") +
labs(x="Powell Active Storage (MAF)", y="Mead Active Storage (MAF)", fill = "Powell Release (MAF/year)") +
theme(text = element_text(size=20), legend.text=element_text(size=16),
panel.border = element_rect(colour = "black", fill="NA"),
legend.background = element_blank(),
legend.box.background = element_rect(colour = "black", fill=palGreys[2]),
legend.position = c(1.13,0.620))
print(p)
#Low Resolution version
ggsave(paste0(cFileNames[i],cFileType), width=9, height = 6.5, units="in", dpi=96)
#High Resolution version
ggsave(paste0(cFileNames[i],"-HRES",cFileType), width=9, height = 6.5, units="in", dpi=300)
}
dfJointStorageFiltBefore[-seq(0,length(dfJointStorageFiltBefore),2),]
dfJointStorageFiltBefore[seq(1,length(dfJointStorageFiltBefore),2),]
seq(1,20,2)
dfJointStorageFiltBefore[seq(1,length(dfJointStorageFiltBefore),2),]
dfJointStorageFiltBefore[seq(1,nrow(dfJointStorageFiltBefore),2),]
for (i in cS){
p <- ggplot(dfPolyAll, aes(x = PowellVol, y = MeadVol)) +
#Background tiers of different blues
geom_polygon(aes(fill = as.factor(DumVal), group = id)) +
#Plot equalization lines for years
geom_line(data = dfPowellEqPlot, aes(x = Volume, y = value,group=Year, color="Equalization levels (Year)"),size=1.25, linetype=2, show.legend = FALSE) +
#Label the boundary between the Upper Equalization Tier and the Equalization Tier (year dependent)
geom_text(data=dfPowellEqLevelsFilt, aes( x = Volume + 0.4, y = MeadEnd/5, label = YearAsLabel), color="black", angle = 90, size = 5) +
# Plot a 1:1 line to total storage
geom_line(data=dfOneToOneByVolume,aes(x=PowellStor,y=MeadStor, group=1, color="1:1 line (by volume)"), size=2, linetype="longdash", show.legend = FALSE) +
#Label the 1:1 line
geom_text(aes(x=3.5,y=4.2,label="1:1 line"), color="black", angle = 45, size =6, show.legend = FALSE)
if (i==2){
#Overplot Mead-Powell historical storage -- January of each year
#Before guidelines in place in Red
p<- p + geom_path(data = dfJointStorageFiltBefore, aes(x = PowellStorage, y = MeadStorage, color="Before Guidelines"), size=1.5, linetype=1, show.legend = TRUE)
#After guidelines in place in purple
p<- p + geom_path(data = dfJointStorageFiltAfter, aes(x = PowellStorage, y = MeadStorage, color="After Guidelines"), size=1.5, linetype=1, show.legend = TRUE)
}
if (i==3){
#Overplot Mead-Powell historical storage -- all months
#Before guidelines in place in Red
p <- p+ geom_path(data = dfJointStorageBefore, aes(x = PowellStorage, y = MeadStorage, color="Before Guidelines"), size=1, linetype=1, show.legend = TRUE)
#After guidelines in place in Purple
p <- p+ geom_path(data = dfJointStorageAfter, aes(x = PowellStorage, y = MeadStorage, color="After Guidelines"), size=1, linetype=1, show.legend = TRUE)
}
if (i==2 || i==3) {
#Label the each January with it's year
p <- p + geom_text_repel(data=dfJointStorageFiltBefore[-seq(0,nrow(dfJointStorageFiltBefore),2),], aes( x = PowellStorage, y = MeadStorage, label = year(DateAsValue), color="BeforeGuidesText", angle = 0, size = 4, check_overlap = TRUE))
#p <- p + geom_text(data=dfJointStorageFiltAfter, aes( x = PowellStorage, y = MeadStorage, label = year(DateAsValue), color="AfterGuidesText", angle = 0, size = 4, check_overlap = TRUE))
p <- p + geom_text_repel(data=dfJointStorageFiltAfter[-seq(0,nrow(dfJointStorageFiltBefore),2),], aes( x = PowellStorage, y = MeadStorage, label = year(DateAsValue), color="AfterGuidesText", angle = 0, size = 4, check_overlap = TRUE))
}
#set colors for lines
p <- p + scale_color_manual(breaks = c("Before Guidelines", "After Guidelines"),
values= c("black",palPurples[8], "black", palPurples[5], "black","black"),
labels = c("Before Guidelines", "With Guidelines")) +
#Label the equalization tiers with white callouts
geom_label(data=dfPowellTiers, aes(x = PowellMidVol, y = MeadMid, label = Tier, fontface="bold"), size=5, angle = 0) +
#Label the annual release amount within each equalization tier
geom_text(data=dfReleases, aes( x = MidPowell, y = MidMead, label = Release), angle = 0, size = 5) +
#Create secondary y axes for Mead Lake Level
scale_y_continuous(breaks = c(0,5,10,15,20,25),labels=c(0,5,10,15, 20,25),  sec.axis = sec_axis(~. +0, name = "Mead Level (feet)", breaks = dfMeadPoolsPlot$stor_maf, labels = dfMeadPoolsPlot$label)) +
#Create secodary x axes for Powell Lake Level
scale_x_continuous(sec.axis = sec_axis(~. +0, name = "Powell Level (feet)", breaks = c(0,5.93,9.52,15.54,19.29,24.32) , labels = c(3370,3525,3575,3636,3666,3700))) +
#Specify fill colors for equalization tier quadrants
scale_fill_manual(breaks=c(1:7),values = cTierColors,labels = dfReleases$Release) +
theme_bw() +
coord_fixed() +
guides(size = "none", colour = guide_legend("Historical volumes (year)"), fill="none") +
labs(x="Powell Active Storage (MAF)", y="Mead Active Storage (MAF)", fill = "Powell Release (MAF/year)") +
theme(text = element_text(size=20), legend.text=element_text(size=16),
panel.border = element_rect(colour = "black", fill="NA"),
legend.background = element_blank(),
legend.box.background = element_rect(colour = "black", fill=palGreys[2]),
legend.position = c(1.13,0.620))
print(p)
#Low Resolution version
ggsave(paste0(cFileNames[i],cFileType), width=9, height = 6.5, units="in", dpi=96)
#High Resolution version
ggsave(paste0(cFileNames[i],"-HRES",cFileType), width=9, height = 6.5, units="in", dpi=300)
}
for (i in cS){
p <- ggplot(dfPolyAll, aes(x = PowellVol, y = MeadVol)) +
#Background tiers of different blues
geom_polygon(aes(fill = as.factor(DumVal), group = id)) +
#Plot equalization lines for years
geom_line(data = dfPowellEqPlot, aes(x = Volume, y = value,group=Year, color="Equalization levels (Year)"),size=1.25, linetype=2, show.legend = FALSE) +
#Label the boundary between the Upper Equalization Tier and the Equalization Tier (year dependent)
geom_text(data=dfPowellEqLevelsFilt, aes( x = Volume + 0.4, y = MeadEnd/5, label = YearAsLabel), color="black", angle = 90, size = 5) +
# Plot a 1:1 line to total storage
geom_line(data=dfOneToOneByVolume,aes(x=PowellStor,y=MeadStor, group=1, color="1:1 line (by volume)"), size=2, linetype="longdash", show.legend = FALSE) +
#Label the 1:1 line
geom_text(aes(x=3.5,y=4.2,label="1:1 line"), color="black", angle = 45, size =6, show.legend = FALSE)
if (i==2){
#Overplot Mead-Powell historical storage -- January of each year
#Before guidelines in place in Red
p<- p + geom_path(data = dfJointStorageFiltBefore, aes(x = PowellStorage, y = MeadStorage, color="Before Guidelines"), size=1.5, linetype=1, show.legend = TRUE)
#After guidelines in place in purple
p<- p + geom_path(data = dfJointStorageFiltAfter, aes(x = PowellStorage, y = MeadStorage, color="After Guidelines"), size=1.5, linetype=1, show.legend = TRUE)
}
if (i==3){
#Overplot Mead-Powell historical storage -- all months
#Before guidelines in place in Red
p <- p+ geom_path(data = dfJointStorageBefore, aes(x = PowellStorage, y = MeadStorage, color="Before Guidelines"), size=1, linetype=1, show.legend = TRUE)
#After guidelines in place in Purple
p <- p+ geom_path(data = dfJointStorageAfter, aes(x = PowellStorage, y = MeadStorage, color="After Guidelines"), size=1, linetype=1, show.legend = TRUE)
}
if (i==2 || i==3) {
#Label the each January with it's year
p <- p + geom_text_repel(data=dfJointStorageFilt[-seq(0,nrow(dfJointStorageFilt),2),], aes( x = PowellStorage, y = MeadStorage, label = year(DateAsValue), color="YearsText", angle = 0, size = 4, check_overlap = TRUE))
#p <- p + geom_text(data=dfJointStorageFiltAfter, aes( x = PowellStorage, y = MeadStorage, label = year(DateAsValue), color="AfterGuidesText", angle = 0, size = 4, check_overlap = TRUE))
#p <- p + geom_text_repel(data=dfJointStorageFiltAfter[-seq(0,nrow(dfJointStorageFiltBefore),2),], aes( x = PowellStorage, y = MeadStorage, label = year(DateAsValue), color="AfterGuidesText", angle = 0, size = 4, check_overlap = TRUE))
}
#set colors for lines
p <- p + scale_color_manual(breaks = c("Before Guidelines", "After Guidelines"),
values= c("black",palPurples[8], palPurples[5], "black","black"),
labels = c("Before Guidelines", "With Guidelines")) +
#Label the equalization tiers with white callouts
geom_label(data=dfPowellTiers, aes(x = PowellMidVol, y = MeadMid, label = Tier, fontface="bold"), size=5, angle = 0) +
#Label the annual release amount within each equalization tier
geom_text(data=dfReleases, aes( x = MidPowell, y = MidMead, label = Release), angle = 0, size = 5) +
#Create secondary y axes for Mead Lake Level
scale_y_continuous(breaks = c(0,5,10,15,20,25),labels=c(0,5,10,15, 20,25),  sec.axis = sec_axis(~. +0, name = "Mead Level (feet)", breaks = dfMeadPoolsPlot$stor_maf, labels = dfMeadPoolsPlot$label)) +
#Create secodary x axes for Powell Lake Level
scale_x_continuous(sec.axis = sec_axis(~. +0, name = "Powell Level (feet)", breaks = c(0,5.93,9.52,15.54,19.29,24.32) , labels = c(3370,3525,3575,3636,3666,3700))) +
#Specify fill colors for equalization tier quadrants
scale_fill_manual(breaks=c(1:7),values = cTierColors,labels = dfReleases$Release) +
theme_bw() +
coord_fixed() +
guides(size = "none", colour = guide_legend("Historical volumes (year)"), fill="none") +
labs(x="Powell Active Storage (MAF)", y="Mead Active Storage (MAF)", fill = "Powell Release (MAF/year)") +
theme(text = element_text(size=20), legend.text=element_text(size=16),
panel.border = element_rect(colour = "black", fill="NA"),
legend.background = element_blank(),
legend.box.background = element_rect(colour = "black", fill=palGreys[2]),
legend.position = c(1.13,0.620))
print(p)
#Low Resolution version
ggsave(paste0(cFileNames[i],cFileType), width=9, height = 6.5, units="in", dpi=96)
#High Resolution version
ggsave(paste0(cFileNames[i],"-HRES",cFileType), width=9, height = 6.5, units="in", dpi=300)
}
dfJointStorageFilt <- dfJointStorage %>% arrange(dfJointStorage$DateAsValue) %>% filter(month(dfJointStorage$DateAsValue) == 1)
for (i in cS){
p <- ggplot(dfPolyAll, aes(x = PowellVol, y = MeadVol)) +
#Background tiers of different blues
geom_polygon(aes(fill = as.factor(DumVal), group = id)) +
#Plot equalization lines for years
geom_line(data = dfPowellEqPlot, aes(x = Volume, y = value,group=Year, color="Equalization levels (Year)"),size=1.25, linetype=2, show.legend = FALSE) +
#Label the boundary between the Upper Equalization Tier and the Equalization Tier (year dependent)
geom_text(data=dfPowellEqLevelsFilt, aes( x = Volume + 0.4, y = MeadEnd/5, label = YearAsLabel), color="black", angle = 90, size = 5) +
# Plot a 1:1 line to total storage
geom_line(data=dfOneToOneByVolume,aes(x=PowellStor,y=MeadStor, group=1, color="1:1 line (by volume)"), size=2, linetype="longdash", show.legend = FALSE) +
#Label the 1:1 line
geom_text(aes(x=3.5,y=4.2,label="1:1 line"), color="black", angle = 45, size =6, show.legend = FALSE)
if (i==2){
#Overplot Mead-Powell historical storage -- January of each year
#Before guidelines in place in Red
p<- p + geom_path(data = dfJointStorageFiltBefore, aes(x = PowellStorage, y = MeadStorage, color="Before Guidelines"), size=1.5, linetype=1, show.legend = TRUE)
#After guidelines in place in purple
p<- p + geom_path(data = dfJointStorageFiltAfter, aes(x = PowellStorage, y = MeadStorage, color="After Guidelines"), size=1.5, linetype=1, show.legend = TRUE)
}
if (i==3){
#Overplot Mead-Powell historical storage -- all months
#Before guidelines in place in Red
p <- p+ geom_path(data = dfJointStorageBefore, aes(x = PowellStorage, y = MeadStorage, color="Before Guidelines"), size=1, linetype=1, show.legend = TRUE)
#After guidelines in place in Purple
p <- p+ geom_path(data = dfJointStorageAfter, aes(x = PowellStorage, y = MeadStorage, color="After Guidelines"), size=1, linetype=1, show.legend = TRUE)
}
if (i==2 || i==3) {
#Label the each January with it's year
p <- p + geom_text_repel(data=dfJointStorageFilt[-seq(0,nrow(dfJointStorageFilt),2),], aes( x = PowellStorage, y = MeadStorage, label = year(DateAsValue), color="YearsText", angle = 0, size = 4, check_overlap = TRUE))
#p <- p + geom_text(data=dfJointStorageFiltAfter, aes( x = PowellStorage, y = MeadStorage, label = year(DateAsValue), color="AfterGuidesText", angle = 0, size = 4, check_overlap = TRUE))
#p <- p + geom_text_repel(data=dfJointStorageFiltAfter[-seq(0,nrow(dfJointStorageFiltBefore),2),], aes( x = PowellStorage, y = MeadStorage, label = year(DateAsValue), color="AfterGuidesText", angle = 0, size = 4, check_overlap = TRUE))
}
#set colors for lines
p <- p + scale_color_manual(breaks = c("Before Guidelines", "After Guidelines"),
values= c("black",palPurples[8], palPurples[5], "black","black"),
labels = c("Before Guidelines", "With Guidelines")) +
#Label the equalization tiers with white callouts
geom_label(data=dfPowellTiers, aes(x = PowellMidVol, y = MeadMid, label = Tier, fontface="bold"), size=5, angle = 0) +
#Label the annual release amount within each equalization tier
geom_text(data=dfReleases, aes( x = MidPowell, y = MidMead, label = Release), angle = 0, size = 5) +
#Create secondary y axes for Mead Lake Level
scale_y_continuous(breaks = c(0,5,10,15,20,25),labels=c(0,5,10,15, 20,25),  sec.axis = sec_axis(~. +0, name = "Mead Level (feet)", breaks = dfMeadPoolsPlot$stor_maf, labels = dfMeadPoolsPlot$label)) +
#Create secodary x axes for Powell Lake Level
scale_x_continuous(sec.axis = sec_axis(~. +0, name = "Powell Level (feet)", breaks = c(0,5.93,9.52,15.54,19.29,24.32) , labels = c(3370,3525,3575,3636,3666,3700))) +
#Specify fill colors for equalization tier quadrants
scale_fill_manual(breaks=c(1:7),values = cTierColors,labels = dfReleases$Release) +
theme_bw() +
coord_fixed() +
guides(size = "none", colour = guide_legend("Historical volumes (year)"), fill="none") +
labs(x="Powell Active Storage (MAF)", y="Mead Active Storage (MAF)", fill = "Powell Release (MAF/year)") +
theme(text = element_text(size=20), legend.text=element_text(size=16),
panel.border = element_rect(colour = "black", fill="NA"),
legend.background = element_blank(),
legend.box.background = element_rect(colour = "black", fill=palGreys[2]),
legend.position = c(1.13,0.620))
print(p)
#Low Resolution version
ggsave(paste0(cFileNames[i],cFileType), width=9, height = 6.5, units="in", dpi=96)
#High Resolution version
ggsave(paste0(cFileNames[i],"-HRES",cFileType), width=9, height = 6.5, units="in", dpi=300)
}
for (i in cS){
p <- ggplot(dfPolyAll, aes(x = PowellVol, y = MeadVol)) +
#Background tiers of different blues
geom_polygon(aes(fill = as.factor(DumVal), group = id)) +
#Plot equalization lines for years
geom_line(data = dfPowellEqPlot, aes(x = Volume, y = value,group=Year, color="Equalization levels (Year)"),size=1.25, linetype=2, show.legend = FALSE) +
#Label the boundary between the Upper Equalization Tier and the Equalization Tier (year dependent)
geom_text(data=dfPowellEqLevelsFilt, aes( x = Volume + 0.4, y = MeadEnd/5, label = YearAsLabel), color="black", angle = 90, size = 5) +
# Plot a 1:1 line to total storage
geom_line(data=dfOneToOneByVolume,aes(x=PowellStor,y=MeadStor, group=1, color="1:1 line (by volume)"), size=2, linetype="longdash", show.legend = FALSE) +
#Label the 1:1 line
geom_text(aes(x=3.5,y=4.2,label="1:1 line"), color="black", angle = 45, size =6, show.legend = FALSE)
if (i==2){
#Overplot Mead-Powell historical storage -- January of each year
#Before guidelines in place in Red
p<- p + geom_path(data = dfJointStorageFiltBefore, aes(x = PowellStorage, y = MeadStorage, color="Before Guidelines"), size=1.5, linetype=1, show.legend = TRUE)
#After guidelines in place in purple
p<- p + geom_path(data = dfJointStorageFiltAfter, aes(x = PowellStorage, y = MeadStorage, color="After Guidelines"), size=1.5, linetype=1, show.legend = TRUE)
}
if (i==3){
#Overplot Mead-Powell historical storage -- all months
#Before guidelines in place in Red
p <- p+ geom_path(data = dfJointStorageBefore, aes(x = PowellStorage, y = MeadStorage, color="Before Guidelines"), size=1, linetype=1, show.legend = TRUE)
#After guidelines in place in Purple
p <- p+ geom_path(data = dfJointStorageAfter, aes(x = PowellStorage, y = MeadStorage, color="After Guidelines"), size=1, linetype=1, show.legend = TRUE)
}
if (i==2 || i==3) {
#Label the each January with it's year
p <- p + geom_text(data=dfJointStorageFilt[-seq(0,nrow(dfJointStorageFilt),2),], aes( x = PowellStorage, y = MeadStorage, label = year(DateAsValue), color="YearsText", angle = 0, size = 4, check_overlap = TRUE))
#p <- p + geom_text(data=dfJointStorageFiltAfter, aes( x = PowellStorage, y = MeadStorage, label = year(DateAsValue), color="AfterGuidesText", angle = 0, size = 4, check_overlap = TRUE))
#p <- p + geom_text_repel(data=dfJointStorageFiltAfter[-seq(0,nrow(dfJointStorageFiltBefore),2),], aes( x = PowellStorage, y = MeadStorage, label = year(DateAsValue), color="AfterGuidesText", angle = 0, size = 4, check_overlap = TRUE))
}
#set colors for lines
p <- p + scale_color_manual(breaks = c("Before Guidelines", "After Guidelines"),
values= c("black",palPurples[8], palPurples[5], "black","black"),
labels = c("Before Guidelines", "With Guidelines")) +
#Label the equalization tiers with white callouts
geom_label(data=dfPowellTiers, aes(x = PowellMidVol, y = MeadMid, label = Tier, fontface="bold"), size=5, angle = 0) +
#Label the annual release amount within each equalization tier
geom_text(data=dfReleases, aes( x = MidPowell, y = MidMead, label = Release), angle = 0, size = 5) +
#Create secondary y axes for Mead Lake Level
scale_y_continuous(breaks = c(0,5,10,15,20,25),labels=c(0,5,10,15, 20,25),  sec.axis = sec_axis(~. +0, name = "Mead Level (feet)", breaks = dfMeadPoolsPlot$stor_maf, labels = dfMeadPoolsPlot$label)) +
#Create secodary x axes for Powell Lake Level
scale_x_continuous(sec.axis = sec_axis(~. +0, name = "Powell Level (feet)", breaks = c(0,5.93,9.52,15.54,19.29,24.32) , labels = c(3370,3525,3575,3636,3666,3700))) +
#Specify fill colors for equalization tier quadrants
scale_fill_manual(breaks=c(1:7),values = cTierColors,labels = dfReleases$Release) +
theme_bw() +
coord_fixed() +
guides(size = "none", colour = guide_legend("Historical volumes (year)"), fill="none") +
labs(x="Powell Active Storage (MAF)", y="Mead Active Storage (MAF)", fill = "Powell Release (MAF/year)") +
theme(text = element_text(size=20), legend.text=element_text(size=16),
panel.border = element_rect(colour = "black", fill="NA"),
legend.background = element_blank(),
legend.box.background = element_rect(colour = "black", fill=palGreys[2]),
legend.position = c(1.13,0.620))
print(p)
#Low Resolution version
ggsave(paste0(cFileNames[i],cFileType), width=9, height = 6.5, units="in", dpi=96)
#High Resolution version
ggsave(paste0(cFileNames[i],"-HRES",cFileType), width=9, height = 6.5, units="in", dpi=300)
}
for (i in cS){
p <- ggplot(dfPolyAll, aes(x = PowellVol, y = MeadVol)) +
#Background tiers of different blues
geom_polygon(aes(fill = as.factor(DumVal), group = id)) +
#Plot equalization lines for years
geom_line(data = dfPowellEqPlot, aes(x = Volume, y = value,group=Year, color="Equalization levels (Year)"),size=1.25, linetype=2, show.legend = FALSE) +
#Label the boundary between the Upper Equalization Tier and the Equalization Tier (year dependent)
geom_text(data=dfPowellEqLevelsFilt, aes( x = Volume + 0.4, y = MeadEnd/5, label = YearAsLabel), color="black", angle = 90, size = 5) +
# Plot a 1:1 line to total storage
geom_line(data=dfOneToOneByVolume,aes(x=PowellStor,y=MeadStor, group=1, color="1:1 line (by volume)"), size=2, linetype="longdash", show.legend = FALSE) +
#Label the 1:1 line
geom_text(aes(x=3.5,y=4.2,label="1:1 line"), color="black", angle = 45, size =6, show.legend = FALSE)
if (i==2){
#Overplot Mead-Powell historical storage -- January of each year
#Before guidelines in place in Red
p<- p + geom_path(data = dfJointStorageFiltBefore, aes(x = PowellStorage, y = MeadStorage, color="Before Guidelines"), size=1.5, linetype=1, show.legend = TRUE)
#After guidelines in place in purple
p<- p + geom_path(data = dfJointStorageFiltAfter, aes(x = PowellStorage, y = MeadStorage, color="After Guidelines"), size=1.5, linetype=1, show.legend = TRUE)
}
if (i==3){
#Overplot Mead-Powell historical storage -- all months
#Before guidelines in place in Red
p <- p+ geom_path(data = dfJointStorageBefore, aes(x = PowellStorage, y = MeadStorage, color="Before Guidelines"), size=1, linetype=1, show.legend = TRUE)
#After guidelines in place in Purple
p <- p+ geom_path(data = dfJointStorageAfter, aes(x = PowellStorage, y = MeadStorage, color="After Guidelines"), size=1, linetype=1, show.legend = TRUE)
}
if (i==2 || i==3) {
#Label the each January with it's year
p <- p + geom_text_repel(data=dfJointStorageFilt[-seq(0,nrow(dfJointStorageFilt),2),], point.padding = NA, aes( x = PowellStorage, y = MeadStorage, label = year(DateAsValue), color="YearsText", angle = 0, size = 4, check_overlap = TRUE))
#p <- p + geom_text(data=dfJointStorageFiltAfter, aes( x = PowellStorage, y = MeadStorage, label = year(DateAsValue), color="AfterGuidesText", angle = 0, size = 4, check_overlap = TRUE))
#p <- p + geom_text_repel(data=dfJointStorageFiltAfter[-seq(0,nrow(dfJointStorageFiltBefore),2),], aes( x = PowellStorage, y = MeadStorage, label = year(DateAsValue), color="AfterGuidesText", angle = 0, size = 4, check_overlap = TRUE))
}
#set colors for lines
p <- p + scale_color_manual(breaks = c("Before Guidelines", "After Guidelines"),
values= c("black",palPurples[8], palPurples[5], "black","black"),
labels = c("Before Guidelines", "With Guidelines")) +
#Label the equalization tiers with white callouts
geom_label(data=dfPowellTiers, aes(x = PowellMidVol, y = MeadMid, label = Tier, fontface="bold"), size=5, angle = 0) +
#Label the annual release amount within each equalization tier
geom_text(data=dfReleases, aes( x = MidPowell, y = MidMead, label = Release), angle = 0, size = 5) +
#Create secondary y axes for Mead Lake Level
scale_y_continuous(breaks = c(0,5,10,15,20,25),labels=c(0,5,10,15, 20,25),  sec.axis = sec_axis(~. +0, name = "Mead Level (feet)", breaks = dfMeadPoolsPlot$stor_maf, labels = dfMeadPoolsPlot$label)) +
#Create secodary x axes for Powell Lake Level
scale_x_continuous(sec.axis = sec_axis(~. +0, name = "Powell Level (feet)", breaks = c(0,5.93,9.52,15.54,19.29,24.32) , labels = c(3370,3525,3575,3636,3666,3700))) +
#Specify fill colors for equalization tier quadrants
scale_fill_manual(breaks=c(1:7),values = cTierColors,labels = dfReleases$Release) +
theme_bw() +
coord_fixed() +
guides(size = "none", colour = guide_legend("Historical volumes (year)"), fill="none") +
labs(x="Powell Active Storage (MAF)", y="Mead Active Storage (MAF)", fill = "Powell Release (MAF/year)") +
theme(text = element_text(size=20), legend.text=element_text(size=16),
panel.border = element_rect(colour = "black", fill="NA"),
legend.background = element_blank(),
legend.box.background = element_rect(colour = "black", fill=palGreys[2]),
legend.position = c(1.13,0.620))
print(p)
#Low Resolution version
ggsave(paste0(cFileNames[i],cFileType), width=9, height = 6.5, units="in", dpi=96)
#High Resolution version
ggsave(paste0(cFileNames[i],"-HRES",cFileType), width=9, height = 6.5, units="in", dpi=300)
}
